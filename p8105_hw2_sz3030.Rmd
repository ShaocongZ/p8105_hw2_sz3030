---
title: "p8105_hw2_sz3030"
author: "Shaocong Zhang"
date: "10/9/2021"
output: github_document
---
# Problem 1

## Read and clean the Mr. Trash Wheel sheet

```{r TrashWheelSheet}
library(readxl)
library(tidyverse)

trash.wheel = read_excel("./Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                          sheet = "Mr. Trash Wheel",range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(sports_balls = round(sports_balls))
```

## Read and clean precipitation data for 2018 and 2019

```{r Precipitation}
preciptation_2018 = read_excel("./Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                          sheet = "2018 Precipitation", skip = 1) %>%
  janitor::clean_names() %>%
  drop_na(month, total) %>%
  mutate(year = 2018)

preciptation_2019 = read_excel("./Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                          sheet = "2019 Precipitation", skip = 1) %>%
  janitor::clean_names() %>%
  drop_na(month, total) %>%
  mutate(year = 2019)
```

# Combine precipitation datasets and convert month to a character variable

```{r Combine}
comb_precipitation = bind_rows(preciptation_2018, preciptation_2019) %>%
  mutate(month = month.name[month])
```

For the Mr.Trash Wheel sheet, there are `r nrow(trash.wheel)` observations and `r ncol(trash.wheel)` variables. The variables includes information on the dumpster number, date of collection, amount of total litter and litter type. What's more, the median number of sports balls in a dumpster in 2019 was `r trash.wheel %>% filter(year == 2019) %>% pull(sports_balls) %>% median()`.

For the combined precipitation, there are `r nrow(comb_precipitation)` observations and `r ncol(comb_precipitation)` variables. The variables includes information about the year, month and its total precipitation. What's more, the total precipitation in 2018 is `r comb_precipitation %>% filter(year == 2018) %>% pull(total) %>% sum()`

# Problem 2

## First, clean the data in pols-month.csv.

```{r clean_pols}
pols_moth = read_csv("./fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), convert = TRUE) %>%
  mutate(month = month.name[month], 
    president = recode(prez_dem, "0" = "dem", "1" = "gop")) %>%
  select(-prez_dem, -prez_gop, -day)
```

## Second, clean the data in snp.csv using a similar process to the above.

```{r clean_snp}
snp = read_csv("./fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("year", "month", "day"), convert = TRUE) %>%
  arrange(year, month) %>%
  mutate(month = month.name[month]) %>%
  select(year, month, close) 
```


## Third, tidy the unemployment data so that it can be merged with the previous datasets.

```{r tidy_unemployment}
unemployment = read_csv("./fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(Jan:Dec, names_to = "month", values_to = "unemployment") %>%
  mutate(month = recode(month, Jan = "January", Feb = "February",
                        Mar = "March", Apr = "April",
                        May = "May", Jun = "June",
                        Jul = "July", Aug = "August",
                        Sep = "September", Oct = "October",
                        Nov = "November", Dec = "December")) %>%
  rename(year = Year)
```

## Join the datasets by merging snp into pols, and merging unemployment into the result.

```{r }
comb_prob2 = left_join(pols_moth, snp) %>%
  left_join(., unemployment)
```

The original pols-month.csv dataset is related to the number of national politicians who are democratic or republican at any given time. For pols_moth dataset, there are `r nrow(pols_moth)` observations and `r ncol(pols_moth)` variables. The variables are year(range from `r min(pols_moth$year)` to `r max(pols_moth$year)`), month(from January to December), the number of republican governors on the associated date, the number of national politicians who are democratic or republican(gov_gop, sen_gop, rep_gop, gov_dem, sen_dem and rep_dem) and the sitting president is democratic or republican.

The original snp.csv is  related to Standard & Poorâ€™s stock market index. For the resulting snp dataset, there are `r nrow(snp)` observations and `r ncol(snp)` variables. The variables are year(range from `r min(snp$year)` to `r max(snp$year)`) and the closing values of the S&P stock index on the associated date.

The original unemployment.csv dataset is related to the percentage of unemployment of the associated year in months. For the resulting unemployment dataset, there are `r nrow(unemployment)` observations and `r ncol(unemployment)` variables. The variables are years(range from `r min(unemployment$year)` to `r max(unemployment$year)`), month(from January to December) and the unemployment percentage.

The merged dataset comb_prob2 has `r nrow(comb_prob2)` observations and `r ncol(comb_prob2)` variables. The dataset contains all of the variables above





